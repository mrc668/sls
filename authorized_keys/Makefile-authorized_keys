# /opt/sls/authorized_keys/Makefile-authorized_keys

SHELL := /bin/bash
TARGET := ../authorized_keys
SOURCES := $(wildcard *.pub)
MD5FILE := authorized_keys.md5

all: $(TARGET) $(MD5FILE)

$(TARGET): $(SOURCES) 
	@echo "Rebuilding $(TARGET)..."
	@cat $(SOURCES) > $(TARGET)
	@chmod 600 $(TARGET)

$(MD5FILE): $(TARGET)
	@md5sum $(TARGET) > $(MD5FILE)
	@echo "MD5 updated: $$(cat $(MD5FILE))"

clean:
	rm -f $(TARGET) $(MD5FILE)
